{
  "hash": "1a71a4449c8dd4cd56deba0da568fae6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"One-Way ANOVA\"\nformat: html\nauthor: \"James Van Slyke\"\n---\n\n\n\n\n## One-Way ANOVA\n\nANOVA stands for analysis of variance, which is based on the *F* statistic, which is named after the statistician who invented it, R. A. Fisher. The statistic is fundamentally the ratio of two independent variance estimates of the same population variance (Pagano, 2013). Thus the basic formula is:\n\n$$\nF = \\frac{variance\\;estimate\\; 1\\; of\\; \\sigma^{2}}{variance\\; estimate\\; 2\\; of\\; \\sigma^{2}}\n$$\n\n## How Many Groups?\n\nUltimately the *F* test or ANOVA is used to analyze differences in the means of more than two groups. Remember we use the *t* test to analyze differences in the means of two groups, but when we have more than two groups we need a different test. In this case, we use the *ANOVA*.\n\n## Null and Alternative Hypotheses\n\nHere are the basic assumptions of the two hypotheses used in an ANOVA.\n\nNull $$\nH_0 : \\mu_1=\\mu_2=\\mu_3\n$$ Alternative $$\nH_1 : \\mu_1\\neq\\mu_2\\neq\\mu_3\n$$\n\n## \n\nSo the Null hypothesis assumes there will be no differences between the means or that the groups come from the same population, while the alternative assumes there is a difference between the means or the groups come from different populations. One thing to remember, the ANOVA test can only identify if *some* of the group means are different. It cannot identify which means are different. So the means for group 1 and 2 may be statistically the same, while the means for group 2 and 3 may be different, but the ANOVA test will still be significant.\n\n## Signal vs. Noise\n\nRemember our basic formula for statistics.\n\n$$\nStatistics = \\frac{Signal}{Noise}\n$$\n\n*Signal* refers to systematic variation or variation based on the causal work of the independent variable. Whereas *noise* refers to unsystematic variation or variation which is not the result of the independent variable. Unsystematic variation is the result of measurement error and we've seen that measurement error occurs in all types of measurement and statistics.\n\n## \n\nSo the changes observed in our dataset that are the result of systematic variation have to be *larger* then the differences we observe as the result of unsystematic variation for our statistical finding to be considered significant.\n\n## \n\nRemember that the null hypothesis assumes no differences between the groups, whereas the alternative hypothesis assumes the groups will be different because of the manipulation of the independent variable.\n\n## Levels of the Independent variable\n\nANOVA enables the comparison of more than two groups, which is often structured to analyze different levels of an independent variable. By levels we are referring to different amounts or quantities of the independent variable. For example, one group may be the control group, but then subsequent groups may have different quantities of the independent variable.\n\nHere is the dataset\n\n\n::: {.cell}\n\n```{.r .cell-code}\nch15ds1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Group Language.Score\n1   5 Hours             87\n2   5 Hours             86\n3   5 Hours             76\n4   5 Hours             56\n5   5 Hours             78\n6   5 Hours             98\n7   5 Hours             77\n8   5 Hours             66\n9   5 Hours             75\n10  5 Hours             67\n11 10 Hours             87\n12 10 Hours             85\n13 10 Hours             99\n14 10 Hours             85\n15 10 Hours             79\n16 10 Hours             81\n17 10 Hours             82\n18 10 Hours             78\n19 10 Hours             85\n20 10 Hours             91\n21 20 Hours             89\n22 20 Hours             91\n23 20 Hours             96\n24 20 Hours             87\n25 20 Hours             89\n26 20 Hours             90\n27 20 Hours             89\n28 20 Hours             96\n29 20 Hours             96\n30 20 Hours             93\n```\n\n\n:::\n:::\n\n\nFirst let's look at the independent variable, which is attendance at preschool.\n\nIV = Preschool\n\nHere it is in R studio labeled as \"Group\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\nch15ds1$Group\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"5 Hours\"  \"5 Hours\"  \"5 Hours\"  \"5 Hours\"  \"5 Hours\"  \"5 Hours\" \n [7] \"5 Hours\"  \"5 Hours\"  \"5 Hours\"  \"5 Hours\"  \"10 Hours\" \"10 Hours\"\n[13] \"10 Hours\" \"10 Hours\" \"10 Hours\" \"10 Hours\" \"10 Hours\" \"10 Hours\"\n[19] \"10 Hours\" \"10 Hours\" \"20 Hours\" \"20 Hours\" \"20 Hours\" \"20 Hours\"\n[25] \"20 Hours\" \"20 Hours\" \"20 Hours\" \"20 Hours\" \"20 Hours\" \"20 Hours\"\n```\n\n\n:::\n:::\n\n\nNotice that there is 3 levels to this independent variable based on the amount of time spent in preschool per week: 5 hours, 10 hours, and 20 hours. Notice that there is no control group. Everyone is in preschool. So the hypothesis is really whether *more* time in preschool increases language development.\n\n### Creating Factors\n\nAn important first step for data analysis is to make sure the variables are in the correct format. We can use the `str` command to figure out the types of variables in the dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(ch15ds1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t30 obs. of  2 variables:\n $ Group         : chr  \"5 Hours\" \"5 Hours\" \"5 Hours\" \"5 Hours\" ...\n $ Language.Score: int  87 86 76 56 78 98 77 66 75 67 ...\n```\n\n\n:::\n:::\n\n\nLanguage.Score is an integer `int` or whole number, which makes sense for a measurement scale that is looking at language development.\n\nGroup is a character `chr`, which is fine for defining groups, but we would prefer it to be a factor so it could more easily distinguish the levels of the independent variable.\n\nSo let's change the variable type for group to a factor.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nch15ds1$Group <- factor(ch15ds1$Group, \n    levels = c(\"5 Hours\", \"10 Hours\", \"20 Hours\"))\n```\n:::\n\n\nAnd then check it\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(ch15ds1$Group)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Factor w/ 3 levels \"5 Hours\",\"10 Hours\",..: 1 1 1 1 1 1 1 1 1 1 ...\n```\n\n\n:::\n:::\n\n\n### Are the means different?\n\nThe first question for the dataset is whether the means are different. More specifically, the mean level of language development should *increase* with an increase in hours spent at preschool.\n\n#### Mean difference between the groups\n\n\n::: {.cell}\n\n```{.r .cell-code}\nch15ds1 |> \n  group_by(Group) |> \n  summarise(n = n(),\n            mean = mean(Language.Score))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 3\n  Group        n  mean\n  <fct>    <int> <dbl>\n1 5 Hours     10  76.6\n2 10 Hours    10  85.2\n3 20 Hours    10  91.6\n```\n\n\n:::\n:::\n\n\nSo the means are different and the language score increases with hours spent in preschool. Now it needs to be determined if the differences between the means are statistically significant. This is where we need the *ANOVA* or *F* Test.\n\n## Review\n\nRemember that the F test or ANOVA is based on comparing variation between the groups (signal) to variation within the groups (noise). So the equation is:\n\n$$\nF = \\frac{MS_{between}}{MS_{within}}\n$$\n\nHowever, there are some different steps we need to take to get to the two types of Mean Squares $MS$ for this formula.\n\nFor this usage of the ANOVA, the *total variability* $SS_T$ is partitioned (divided or separated) into 2 groups or sources. The variability between the groups $SS_{between}$ and the variability within the groups $SS_{within}$. Remember that variability between groups gives us evidence that the groups are different and if the variability is greater than the variability within the groups than our F value will be significant.\n\nHowever, the two sum of squares values ($SS_{within}$ & $SS_{between}$) need to be averaged based on the number of scores from which they were calculated in order to eliminate bias. In this case we'll use the degrees of freedom to accomplish this task $df$. Here is the formulas:\n\n$$df_{within} = N - 1$$\n\n$$df_{between}=k-1$$\n\n$N$ stands for the number of observations or participants we have in all the groups because it deals with individual variation. $k$ stands for the number of groups we have because it deals with group variation. Here is an overview of the entire formula.\n\n$$\n\\frac{SS_{between}/df_{between}}{SS_{within}/df_{within}} = \\frac{MS_{between}}{MS_{within}}= F\n$$\n\n### *F* Distribution\n\nHere's a look at the *F* distribution. Notice both the similaries and differences to the binomial and *t* and *z* distributions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndist_f(deg.f1 = 4, deg.f2 = 20, p = .05)\n```\n\n::: {.cell-output-display}\n![](One-Way-ANOVA_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nThe *F* distribution is also a family of curves based on the degrees of freedom. Notice that the distribution has a positive skew (more scores at the lower end of the distribution) and it also only had one tail rather than two tails. This is another indication that the *F* test can't determine the direction of difference between the groups, only if there is a difference between the groups.\n\n## Using R Studio to calculate the ANOVA\n\nIn another section, ANOVA was used to test a linear regression model. For that model a comparison was made between the improvement of the linear model in comparison to the grand mean $SS_{M}$ and the measurement error based on the residuals $SS_{R}$. There is a strong statistical relationship between regression and ANOVA and in fact ANOVA for groups can be understood as a part of the general linear model (GLM). The differences between the groups $SS_{between}$ can be understood as a line composed of the group means and compared to the grand mean $SS_M$. The greater the difference between this line and the grand mean, the greater the difference between the group means. $SS_{within}$ can be understood as the residuals for each observation and the grand mean $SS_R$. Everything else remains the same ($df$, $MS$, and $F$) when running the ANOVA in R Studio.\n\n#### Running the Code\n\nHere's the basic set up for running ANOVA\n\nObject \\<- aov(Dependent Variable \\~ Independent Variable, data = your dataset)\n\nSo in this case\n\n\n::: {.cell}\n\n```{.r .cell-code}\nANOVA_1 <- aov(Language.Score~Group, data = ch15ds1)\n```\n:::\n\n\nFor ANOVA, the results are saved in an object, so we need to use `summary` to get the results.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(ANOVA_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df Sum Sq Mean Sq F value  Pr(>F)   \nGroup        2   1133   566.5   8.799 0.00114 **\nResiduals   27   1738    64.4                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\"Group\" is the independent variable so Sum Sq stands for the $SS_{between}$ or $SS_M$, whereas \"Residuals stands for the $SS_{within}$ or $SS_R$.\n\nThe *F* value is 8.799 and the significance or *p* value is 0.00114, so the results are significant.\n\n### Bar Graph of the Data\n\nStep 1 - create table of Descriptive Statistics\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nPreschool_Descriptives <- ch15ds1 %>%\n  group_by(Group) %>%\n  summarize(n = n(),\n            mean = mean(Language.Score),\n            sd = sd(Language.Score),\n            se = sd / sqrt(n),\n            ci = qt(0.975, df = n - 1) * sd / sqrt(n))\n```\n:::\n\n\nCheck it out\n\n\n::: {.cell}\n\n```{.r .cell-code}\nPreschool_Descriptives\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 6\n  Group        n  mean    sd    se    ci\n  <fct>    <int> <dbl> <dbl> <dbl> <dbl>\n1 5 Hours     10  76.6 12.0   3.78  8.56\n2 10 Hours    10  85.2  6.20  1.96  4.43\n3 20 Hours    10  91.6  3.41  1.08  2.44\n```\n\n\n:::\n:::\n\n\nNow graph it based on the descriptive statistics\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(Preschool_Descriptives, \n       aes(x = Group, \n           y = mean)) +\n  geom_bar(stat = \"identity\") +\n  geom_errorbar(aes(ymin=mean-ci,\n                    ymax=mean+ci))\n```\n\n::: {.cell-output-display}\n![](One-Way-ANOVA_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nMake the graph look better.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(Preschool_Descriptives, \n       aes(x = Group,\n           y = mean)) +\n  theme_minimal() +\n  geom_bar(stat = \"identity\", fill=\"steelblue\") +\n  geom_errorbar(aes(ymin=mean-ci,\n                    ymax=mean+ci), width=.3, size=1) +\n  labs(title = \"Does Preschool Effect Language Development?\", \n       y=\"Mean Score on Language Test\", x=\"Number of Hours Spent in Preschool\") \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](One-Way-ANOVA_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n### Effect Size\n\nFigure out the effect size - Eta squared The formula is SSbetween/SSTotal or SSbetween/SSbetween+SSResidual\n\n\n::: {.cell}\n\n```{.r .cell-code}\n1133/(1133+1738)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.394636\n```\n\n\n:::\n:::\n\n\n### Conclusion\n\nWrite out conclusion\n\n> Number of hours in Preschool had a significant effect on language development, F(2, 27) = 8.799, p = 0.00114, 𝜂2 = 0.39.\n\nWhere is the difference? Need to use post hoc tests\n\n### TukeyHSD\n\nTukeyHSD will tell us where the differences are between the individual groups.\n\nRun TukeyHSD on saved ANOVA results\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTukeyHSD(ANOVA_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = Language.Score ~ Group, data = ch15ds1)\n\n$Group\n                  diff        lwr      upr     p adj\n10 Hours-5 Hours   8.6 -0.2972884 17.49729 0.0596448\n20 Hours-5 Hours  15.0  6.1027116 23.89729 0.0007780\n20 Hours-10 Hours  6.4 -2.4972884 15.29729 0.1941234\n```\n\n\n:::\n:::\n\n\nFinally, write out the whole conclusion.\n\n> TukeyHSD post hoc tests revealed that 20 hours a week of preschool (M=91.6, SE=1.96) resulted in significantly higher levels of language development in comparison to 5 hours (M=76.6, SE=3.78). This difference, -15 95% CI\\[-23.90, -6.10\\] was significant with an adjusted p = .0008.\n\n### \n",
    "supporting": [
      "One-Way-ANOVA_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}